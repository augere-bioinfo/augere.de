# Computing normalized values

We create a `SummarizedExperiment` that contains the normalized expression values from `edgeR::cpm()`.
This is typically useful for visualizing the expression profiles of the top DE genes.

```{r}
norm.se <- se
SummarizedExperiment::rowData(norm.se)$in.use <- seq_len(nrow(norm.se)) %in% y$genes$origin
norm.se$lib.size <- y$samples$lib.size
norm.se$norm.factors <- y$samples$norm.factors
SummarizedExperiment::assay(norm.se, "cpm") <- edgeR::cpm(
    as.matrix(SummarizedExperiment::assay(norm.se, <%= ASSAY %>)), 
    lib.size=norm.se$lib.size, 
    norm.factors=norm.se$norm.factors
)
```

And we save it.

```{r save-norm}
norm.meta <- list(
    title='Normalized RNA-seq data',
    authors=<%= AUTHOR %>,
    type="summarized_experiment"
)
:BEGIN merge-metadata-norm

norm.meta <- c(common.meta, norm.meta)
norm.meta <- norm.meta[!duplicated(names(norm.meta))]
:EN

augere.diff::saveObject(
    norm.se,
    file.path(result.dir, "se"), 
    metadata=norm.meta
)
```

# Session information {-}

```{r}
sessionInfo()
```
